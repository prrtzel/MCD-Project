00000000 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 4/5/2024 9:33:38 PM

00000000  =00200000                  1  DUART   EQU     $00200000  loaded in A0 when needed, regs are offsets 
00000000  =00000001                  2  MR1A    EQU     1   Mode Register1 
00000000  =00000001                  3  MR2A    EQU     1   points here after MR1A is set 
00000000  =00000003                  4  SRA     EQU     3   Status Register (read) 
00000000  =00000003                  5  CSRA    EQU     3   Clock Select Register 
00000000  =00000005                  6  CRA     EQU     5   Command Register 
00000000  =00000007                  7  TBA     EQU     7   Transfer Holding Register 
00000000  =00000007                  8  RBA     EQU     7   Receive Holding Register 
00000000  =00000009                  9  ACR     EQU     9   Auxiliary control register 
00000000  =00000000                 10  RxRDY   EQU     0   Recieve ready bit position 
00000000  =00000002                 11  TxRDY   EQU     2   Transmit ready bit position 
00000000  =000000CC                 12  BAUD    EQU     $CC baud rate value = 19,200 baud 
00000000                            13  
00000000                            14      org $00000000
00000000                            15      
00000000  4EB9 00000006             16      jsr INIT_DUART
00000006                            17  
00000006                            18  
00000006                            19  INIT_DUART  
00000006  41F9 00200000             20      LEA     DUART,A0        A0 points to base DUART address 
0000000C                            21  
0000000C                            22  ; Software reset: 
0000000C  117C 0030 0005            23      MOVE.B  #$30,CRA(A0)    Reset TxA 
00000012  117C 0020 0005            24      MOVE.B  #$20,CRA(A0)    Reset RxA 
00000018  117C 0010 0005            25      MOVE.B  #$10,CRA(A0)    Reset MRA pointer 
0000001E                            26  
0000001E                            27  ; Initialization: 
0000001E  117C 0080 0009            28      MOVE.B      #$80,ACR(A0)        selects baud rate set 2 
00000024  117C 00CC 0003            29      MOVE.B      #BAUD,CSRA(A0)      set 19.2k baud Rx/Tx 
0000002A  117C 0013 0001            30      MOVE.B      #$13,MR1A(A0)       8-bits, no parity, 1 stop bit 
00000030                            31  
00000030                            32   
00000030                            33  ; This is the most important register to set in the 68681 DUART. 
00000030                            34  ; 07 sets: Normal mode, CTS and RTS disabled, stop bit length = 1 
00000030                            35  ; For testing load $#47 to enable auto-echo 
00000030                            36  
00000030  117C 0047 0001            37      MOVE.B  #$47,MR2A(A0)    
00000036  117C 0005 0005            38      MOVE.B  #$05,CRA(A0)    enable Tx and Rx 
0000003C  4E75                      39      RTS     
0000003E                            40  
0000003E                            41  
Line 42 ERROR: Invalid syntax
0000003E                            42  IN_POLL 
0000003E                            43      *checks if reciever is ready
0000003E  1228 0003                 44      MOVE.B  SRA(A0),D1 
Line 45 ERROR: Invalid syntax
00000042                            45      BTST    #0,D1 
Line 46 ERROR: Invalid syntax
00000042                            46      BEQ     IN_POLL 
00000042  1228 0007                 47      MOVE.B  RBA(A0),D1 
Line 48 ERROR: Undefined symbol
00000046  4EB9 004DBD16             48      JSR     PUT_CHAR
0000004C  4E75                      49      RTS 
0000004E                            50  
0000004E                            51  ;PUT CHAR SUBROUTINE 
Line 52 ERROR: Invalid syntax
0000004E                            52  PUT_CHAR  
0000004E  3F02                      53      MOVE.W  D2, -(SP) 
00000050                            54  
00000050                            55  OUT_POLL 
00000050  1428 0003                 56      MOVE.B  SRA(A0),D2 
Line 57 ERROR: Invalid syntax
00000054                            57      BTST    #2,D2 
Line 58 ERROR: Invalid syntax
00000054                            58      BEQ     OUT_POLL 
00000054  1141 0007                 59      MOVE.B  D1,TBA(A0) 
00000058  341F                      60      MOVE.W  (SP)+,D2 
Line 61 ERROR: Invalid syntax
0000005A                            61      RTS  
Line 62 WARNING: END directive missing, starting address not set

8 errors detected
1 warning generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
ACR                 9
BAUD                CC
CRA                 5
CSRA                3
DUART               200000
INIT_DUART          6
MR1A                1
MR2A                1
OUT_POLL            50
RBA                 7
RXRDY               0
SRA                 3
TBA                 7
TXRDY               2
